<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>KidsTV - Final Fix</title>
    <style>
        :root {
            --bg: #05070a;
            --surface: #12151c;
            --accent: #00f2ff;
            --text: #ffffff;
        }

        body, html {
            margin: 0; padding: 0; height: 100%;
            background-color: var(--bg); color: var(--text);
            font-family: 'Segoe UI', sans-serif; overflow: hidden;
        }

        /* –û–°–ù–û–í–ù–ê –°–Ü–¢–ö–ê */
        .app-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        /* –ü–õ–ï–Ñ–† */
        .video-viewport {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #000;
        }

        .video-wrapper {
            position: relative;
            flex-grow: 1;
            width: 100%;
        }

        .video-wrapper iframe {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            border: none;
        }

        /* –ü–ê–ù–ï–õ–¨ –ö–ï–†–£–í–ê–ù–ù–Ø */
        .bottom-bar {
            background: var(--surface);
            padding: 10px;
            display: flex;
            gap: 10px;
            justify-content: center;
            border-top: 1px solid #333;
        }

        .btn {
            border: none; color: white;
            padding: 12px 20px;
            border-radius: 12px;
            font-weight: bold;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .btn-next { background: linear-gradient(45deg, #00c6ff, #0072ff); flex-grow: 1; max-width: 250px; }
        .btn-list { background: #333; display: none; } /* –¢—ñ–ª—å–∫–∏ –¥–ª—è –º–æ–±—ñ–ª–æ–∫ */

        /* –°–ü–ò–°–û–ö –í–Ü–î–ï–û (–ë–û–ö–û–í–ò–ô) */
        .sidebar {
            width: 350px;
            background: var(--surface);
            border-left: 1px solid #333;
            overflow-y: auto;
            display: block;
        }

        .video-card {
            padding: 10px;
            cursor: pointer;
            border-bottom: 1px solid #222;
            display: flex;
            gap: 10px;
        }

        .video-card:hover { background: #1a1e26; }
        .video-card img { width: 120px; border-radius: 8px; }
        .video-card div { font-size: 0.8rem; overflow: hidden; }

        /* --- –ê–î–ê–ü–¢–ò–í–ù–Ü–°–¢–¨ --- */

        /* –î–õ–Ø –ü–ö (–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ) */
        @media (min-width: 900px) {
            .app-container { flex-direction: row; }
            .sidebar { display: block ! from; }
        }

        /* –î–õ–Ø –ú–û–ë–Ü–õ–û–ö */
        @media (max-width: 899px) {
            .sidebar {
                position: fixed;
                bottom: -100%; /* –°—Ö–æ–≤–∞–Ω–æ –∑–Ω–∏–∑—É */
                left: 0; width: 100%; height: 70%;
                z-index: 1000;
                border-left: none;
                border-top: 2px solid var(--accent);
                transition: 0.3s ease-in-out;
                border-radius: 20px 20px 0 0;
            }
            .sidebar.active { bottom: 0; }
            .btn-list { display: block; } /* –ü–æ–∫–∞–∑—É—î–º–æ –∫–Ω–æ–ø–∫—É —Å–ø–∏—Å–∫—É */
            
            /* –ó–∞—Å—Ç–∞–≤–∫–∞ –¥–ª—è –ø–æ–≤–æ—Ä–æ—Ç—É */
            #rotate-hint {
                display: none;
                position: fixed; top:0; left:0; width:100%; height:100%;
                background: #000; z-index: 9999;
                flex-direction: column; justify-content: center; align-items: center;
            }
        }

        @media (max-width: 899px) and (orientation: portrait) {
            #rotate-hint { display: flex; }
        }

        /* –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä–∏—Ç—Ç—è —à—Ç–æ—Ä–∫–∏ –Ω–∞ –º–æ–±—ñ–ª—Ü—ñ */
        .close-sidebar {
            display: none;
            width: 100%; padding: 10px; background: #222; 
            text-align: center; font-weight: bold; color: var(--accent);
        }
        @media (max-width: 899px) { .close-sidebar { display: block; } }

    </style>
</head>
<body>

<div id="rotate-hint">
    <div style="font-size: 50px;">üîÑ</div>
    <h3>–ü–æ–≤–µ—Ä–Ω–∏ —Ç–µ–ª–µ—Ñ–æ–Ω</h3>
</div>

<div class="app-container">
    <div class="video-viewport">
        <div class="video-wrapper">
            <iframe id="main-player" src="" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
        <div class="bottom-bar">
            <button class="btn btn-list" onclick="toggleSidebar()">üìÇ –°–ü–ò–°–û–ö</button>
            <button class="btn btn-next" onclick="playRandom()">üöÄ –Ü–ù–®–ï</button>
        </div>
    </div>

    <div id="sidebar" class="sidebar">
        <div class="close-sidebar" onclick="toggleSidebar()">üîΩ –ó–ê–ö–†–ò–¢–ò –°–ü–ò–°–û–ö</div>
        <div id="video-list"></div>
    </div>
</div>

<script>
    const API_KEY = 'AIzaSyCnUi9wAbsDwiq0FPYiVKLWIgyKHLDKFig';
    const channelIds = ['UCiDMw6_5dn59S8S-S_Vr23A', 'UC_qs3c6ehD78pntpUo_T_Gg', 'UC4S7X8LNoq8m6_Yf_7S6yqA'];
    let allVideos = [];

    function toggleSidebar() {
        document.getElementById('sidebar').classList.toggle('active');
    }

    async function init() {
        for (const id of channelIds) {
            try {
                const res = await fetch(`https://www.googleapis.com/youtube/v3/search?key=${API_KEY}&channelId=${id}&part=snippet&maxResults=15&type=video&videoEmbeddable=true`);
                const data = await res.json();
                if (data.items) {
                    data.items.forEach(v => allVideos.push({
                        id: v.id.videoId, 
                        title: v.snippet.title, 
                        thumb: v.snippet.thumbnails.medium.url
                    }));
                }
            } catch (e) {}
        }
        allVideos.sort(() => Math.random() - 0.5);
        render();
        if(allVideos.length > 0) loadVideo(allVideos[0].id);
    }

    function render() {
        document.getElementById('video-list').innerHTML = allVideos.map(v => `
            <div class="video-card" onclick="loadVideo('${v.id}'); toggleSidebar()">
                <img src="${v.thumb}">
                <div>${v.title}</div>
            </div>
        `).join('');
    }

    function loadVideo(id) {
        document.getElementById('main-player').src = `https://www.youtube.com/embed/${id}?autoplay=1&rel=0&modestbranding=1`;
    }

    function playRandom() {
        const v = allVideos[Math.floor(Math.random() * allVideos.length)];
        if(v) loadVideo(v.id);
    }

    init();
</script>
</body>
</html>
